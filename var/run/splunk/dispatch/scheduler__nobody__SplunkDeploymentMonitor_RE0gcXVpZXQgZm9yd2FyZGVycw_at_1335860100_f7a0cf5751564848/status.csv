state,user,start,"run_time","disk_usage",count,"scan_count","drop_count","available_count",cursor,keywords,done,finalized,"status_buckets","max_time","max_count","reduce_freq","relevant_fields","remote_timeline",resultcount,"result_preview_count","preview_enabled","num_previews",search,error,earliest,latest,"api_et","api_lt","search_et","search_lt",streaming,"events_search","events_streamed","events_sorted","report_search","events_fields_count",servers,"remote_search","events_istruncated",label,"is_saved_search","lookups_enabled","search_providers",pid,priority,realtimesearch,"column_order"
DONE,"splunk-system-user",1335860116,"2.022000",73728,0,0,0,0,0,"index::summary_forwarders status::quiet",1,0,0,0,500000,10,"_time
eps
lastConnected
lastReceived
status",0,0,0,0,0,"search `all_forwarders` | search status=""quiet"" | sort - lastReceived | eval eps = round(eps,4) | fields sourceHost sourceIp connectionType lastConnected lastReceived KB eps status | rename sourceHost as ""Forwarder"" sourceIp as ""Source IP"" connectionType as ""Forwarder Type"" lastConnected as ""Last Connected"" lastReceived as ""Last Data Received"" KB as ""Total KB"" eps as ""Average Events Per Second"" status as ""Current Status""  | fieldformat ""Last Connected""=strftime('Last Connected', ""%D %H:%M:%S %p"")  | fieldformat ""Last Data Received""=strftime('Last Data Received', ""%D %H:%M:%S %p"")","","1335718800.000000000","1335860100.000000000","1335718800.000000000","1335860100.000000000","1335718800.000000000","1335860100.000000000",0,"search index=""summary_forwarders""  | eval _time = _time + 1800 ",1,desc,"stats  first(sourceIp) as sourceIp first(connectionType) as connectionType first(sourcePort) as sourcePort first(build) as build first(version) as version first(os) as os first(arch) as arch max(lastConnected) as lastConnected max(lastReceived) as lastReceived sum(kb) as KB first(avg_eps) as eps by sourceHost guid  | join  type=outer guid  [search earliest=-30m latest=now index=""_internal"" source=""*metrics.log"" group=tcpin_connections | eval sourceHost=if(isnull(hostname), sourceHost,hostname) | eval connectionType=case(fwdType==""uf"",""universal forwarder"", fwdType==""lwf"", ""lightweight forwarder"",fwdType==""full"", ""heavy forwarder"", connectionType==""cooked"" or connectionType==""cookedSSL"",""Splunk forwarder"", connectionType==""raw"" or connectionType==""rawSSL"",""legacy forwarder"")| eval build=if(isnull(build),""n/a"",build) | eval version=if(isnull(version),""pre 4.2"",version) | eval guid=if(isnull(guid),sourceHost,guid) | eval os=if(isnull(os),""n/a"",os)| eval arch=if(isnull(arch),""n/a"",arch) | fields connectionType sourceIp sourceHost sourcePort destPort kb tcp_eps tcp_Kprocessed tcp_KBps splunk_server build version os arch guid | eval lastReceived = if(kb>0, _time, null) | stats first(sourceIp) as sourceIp first(connectionType) as connectionType first(sourcePort) as sourcePort first(build) as build first(version) as version first(os) as os first(arch) as arch max(_time) as lastConnected1 max(lastReceived) as lastReceived1 sum(kb) as kb by sourceHost guid  | addinfo | eval mystatus = if(lastConnected>(lastReceived+300) or kb==0,""quiet"",""dunno"") ]   | eval  lastConnected=if(lastConnected1>lastConnected, lastConnected1, lastConnected)  | eval  lastReceived=if(lastReceived1>lastReceived, lastReceived1, lastReceived)  | addinfo  | eval  status = if(isnull(KB) or lastConnected<(info_max_time-900),""missing"",if(mystatus=""quiet"",""quiet"",""active""))  | search status=""quiet""  | sort  - lastReceived  | eval  eps = round(eps,4)  | fields  sourceHost sourceIp connectionType lastConnected lastReceived KB eps status  | rename  sourceHost as ""Forwarder"" sourceIp as ""Source IP"" connectionType as ""Forwarder Type"" lastConnected as ""Last Connected"" lastReceived as ""Last Data Received"" KB as ""Total KB"" eps as ""Average Events Per Second"" status as ""Current Status""  ",0,"*","litsearch index=""summary_forwarders"" | eval  _time = _time + 1800  | addinfo  type=count label=prereport_events | fields  keepcolorder=t ""arch"" ""avg_eps"" ""build"" ""connectionType"" ""guid"" ""kb"" ""lastConnected"" ""lastReceived"" ""os"" ""prestats_reserved_*"" ""psrsvd_*"" ""sourceHost"" ""sourceIp"" ""sourcePort"" ""version"" | prestats  first(sourceIp) as sourceIp first(connectionType) as connectionType first(sourcePort) as sourcePort first(build) as build first(version) as version first(os) as os first(arch) as arch max(lastConnected) as lastConnected max(lastReceived) as lastReceived sum(kb) as KB first(avg_eps) as eps by sourceHost guid",1,"DM quiet forwarders",1,1,"linux-ahv8.site-bigjava",7829,5,0,"Forwarder
Source IP
Forwarder Type
Last Connected
Last Data Received
Total KB
Average Events Per Second
Current Status
_*"
