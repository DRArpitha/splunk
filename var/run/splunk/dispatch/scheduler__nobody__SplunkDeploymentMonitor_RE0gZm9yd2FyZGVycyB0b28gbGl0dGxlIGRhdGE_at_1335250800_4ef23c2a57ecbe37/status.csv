state,user,start,"run_time","disk_usage",count,"scan_count","drop_count","available_count",cursor,keywords,done,finalized,"status_buckets","max_time","max_count","reduce_freq","relevant_fields","remote_timeline",resultcount,"result_preview_count","preview_enabled","num_previews",search,error,earliest,latest,"api_et","api_lt","search_et","search_lt",streaming,"events_search","events_streamed","events_sorted","report_search","events_fields_count",servers,"remote_search","events_istruncated",label,"is_saved_search","lookups_enabled","search_providers",pid,priority,realtimesearch,"column_order"
DONE,"splunk-system-user",1335250888,"3.453000",86016,0,1,0,0,0,"group::tcpin_connections index::_internal source::*metrics.log",1,0,0,0,500000,10,"arch
avg_kb_last_week
avg_kb_today
build
connectionType
guid
kb_diff
kb_diff_perc
os
sourceHost
version",0,0,0,0,0,"search `forwarder_metrics` | `forwarder_metrics_stats` avg(kb) as avg_kb_today by guid  | join guid type=outer [search earliest=-169h@h latest=-168h@h `forwarder_metrics`| stats avg(kb) as avg_kb_last_week by guid] | fillnull avg_kb_today avg_kb_last_week | appendcols [search `indexer_ratio` | fields indexer_ratio] | streamstats first(indexer_ratio) as indexer_ratio |  where indexer_ratio*.5*avg_kb_last_week > avg_kb_today | eval kb_diff = abs(round(avg_kb_last_week - avg_kb_today, 4)) | eval kb_diff_perc = round(100*kb_diff/avg_kb_last_week, 4) | eval avg_kb_last_week = round(avg_kb_last_week, 4) | eval avg_kb_today = round(avg_kb_today, 4) |  fields sourceHost connectionType avg_kb_last_week avg_kb_today kb_diff kb_diff_perc | rename sourceHost as ""Forwarder"" avg_kb_last_week as ""Average KBps Last Week"" avg_kb_today as ""Average KBps Today"" connectionType as ""Forwarder Type""  kb_diff as ""KBps Difference from Last Week"" kb_diff_perc as ""Percentage Difference""","","1335247200.000000000","1335250800.000000000","1335247200.000000000","1335250800.000000000","1335247200.000000000","1335250800.000000000",0,"search index=""_internal"" source=""*metrics.log"" group=tcpin_connections  | eval sourceHost=if(isnull(hostname), sourceHost,hostname)  | eval connectionType=case(fwdType==""uf"",""universal forwarder"", fwdType==""lwf"", ""lightweight forwarder"",fwdType==""full"", ""heavy forwarder"", connectionType==""cooked"" or connectionType==""cookedSSL"",""Splunk forwarder"", connectionType==""raw"" or connectionType==""rawSSL"",""legacy forwarder"") | eval build=if(isnull(build),""n/a"",build)  | eval version=if(isnull(version),""pre 4.2"",version)  | eval guid=if(isnull(guid),sourceHost,guid)  | eval os=if(isnull(os),""n/a"",os) | eval arch=if(isnull(arch),""n/a"",arch)  | fields connectionType sourceIp sourceHost sourcePort destPort kb tcp_eps tcp_Kprocessed tcp_KBps splunk_server build version os arch guid ",1,desc,"stats  values(sourceHost) as sourceHost values(connectionType) as connectionType values(sourcePort) as sourcePort values(destPort) as destPort sum(kb) avg(tcp_eps) avg(tcp_Kprocessed) avg(tcp_KBps) avg(kb) as avg_kb_today by guid   | join  guid type=outer  [search earliest=-169h@h latest=-168h@h index=""_internal"" source=""*metrics.log"" group=tcpin_connections | eval sourceHost=if(isnull(hostname), sourceHost,hostname) | eval connectionType=case(fwdType==""uf"",""universal forwarder"", fwdType==""lwf"", ""lightweight forwarder"",fwdType==""full"", ""heavy forwarder"", connectionType==""cooked"" or connectionType==""cookedSSL"",""Splunk forwarder"", connectionType==""raw"" or connectionType==""rawSSL"",""legacy forwarder"")| eval build=if(isnull(build),""n/a"",build) | eval version=if(isnull(version),""pre 4.2"",version) | eval guid=if(isnull(guid),sourceHost,guid) | eval os=if(isnull(os),""n/a"",os)| eval arch=if(isnull(arch),""n/a"",arch) | fields connectionType sourceIp sourceHost sourcePort destPort kb tcp_eps tcp_Kprocessed tcp_KBps splunk_server build version os arch guid| stats avg(kb) as avg_kb_last_week by guid]   | fillnull  avg_kb_today avg_kb_last_week  | appendcols  [search earliest=-1h@h latest=now index=""_internal"" source=""*metrics.log"" group=per_index_thruput series!=""_*"" | stats avg(kb) as indexer_avg_kb_today | join splunk_server type=outer [search earliest=-169h@h latest=-168h@h index=""_internal"" source=""*metrics.log"" group=per_index_thruput series!=""_*""| stats avg(kb) as indexer_avg_kb_last_week count | fillnull indexer_avg_kb_last_week | fields indexer_avg_kb_last_week] | fillnull indexer_avg_kb_today | eval indexer_ratio=indexer_avg_kb_today/indexer_avg_kb_last_week | fields indexer_ratio] | streamstats  first(indexer_ratio) as indexer_ratio  | where  indexer_ratio*.5*avg_kb_last_week > avg_kb_today  | eval  kb_diff = abs(round(avg_kb_last_week - avg_kb_today, 4))  | eval  kb_diff_perc = round(100*kb_diff/avg_kb_last_week, 4)  | eval  avg_kb_last_week = round(avg_kb_last_week, 4)  | eval  avg_kb_today = round(avg_kb_today, 4)  | fields  sourceHost connectionType avg_kb_last_week avg_kb_today kb_diff kb_diff_perc  | rename  sourceHost as ""Forwarder"" avg_kb_last_week as ""Average KBps Last Week"" avg_kb_today as ""Average KBps Today"" connectionType as ""Forwarder Type""  kb_diff as ""KBps Difference from Last Week"" kb_diff_perc as ""Percentage Difference""",0,"*","litsearch index=""_internal"" source=""*metrics.log"" group=tcpin_connections | eval  sourceHost=if(isnull(hostname), sourceHost,hostname)  | eval  connectionType=case(fwdType==""uf"",""universal forwarder"", fwdType==""lwf"", ""lightweight forwarder"",fwdType==""full"", ""heavy forwarder"", connectionType==""cooked"" or connectionType==""cookedSSL"",""Splunk forwarder"", connectionType==""raw"" or connectionType==""rawSSL"",""legacy forwarder"") | eval  build=if(isnull(build),""n/a"",build)  | eval  version=if(isnull(version),""pre 4.2"",version)  | eval  guid=if(isnull(guid),sourceHost,guid)  | eval  os=if(isnull(os),""n/a"",os) | eval  arch=if(isnull(arch),""n/a"",arch)  | fields  connectionType sourceIp sourceHost sourcePort destPort kb tcp_eps tcp_Kprocessed tcp_KBps splunk_server build version os arch guid  | addinfo  type=count label=prereport_events | fields  keepcolorder=t ""connectionType"" ""destPort"" ""guid"" ""kb"" ""prestats_reserved_*"" ""psrsvd_*"" ""sourceHost"" ""sourcePort"" ""tcp_KBps"" ""tcp_Kprocessed"" ""tcp_eps"" | prestats  values(sourceHost) as sourceHost values(connectionType) as connectionType values(sourcePort) as sourcePort values(destPort) as destPort sum(kb) avg(tcp_eps) avg(tcp_Kprocessed) avg(tcp_KBps) avg(kb) as avg_kb_today by guid",1,"DM forwarders too little data",1,1,"linux-ahv8.site-bigjava",10233,5,0,"Forwarder
Forwarder Type
Average KBps Last Week
Average KBps Today
KBps Difference from Last Week
Percentage Difference
_*"
